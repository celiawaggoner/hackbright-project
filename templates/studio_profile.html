{% extends 'base.html' %}
{% block content %}

{% for studio in studios %}
<div>
    <img src="{{ studio.image_url }}">
    <h3>{{ studio.name }}</h3>
    <h4>Address:</h4>
    {% for item in studio.location.display_address %}
    <p>{{ item }}</p>
    {% endfor %}
    <h4>Categories:</h4>
    <ul>
        {% for category in studio.categories %}
        <li>{{ category.name }}</li>
        {% endfor %}
    </ul>
    <img src ="{{ studio.rating_img_url }}">
</div>
<hr>


<div>
    <h4>Ratings</h4>
    <p>Overall score: </p>
    <p>Amenities score: </p>
    <p>Cleanliness score: </p>
    <p>Class size score: </p>
    <p>Schedule score: </p>
    <p>Pace score: </p>
</div>

{% if session.user %}
<a href="/write-a-review/{{ studio.id }}"><button type="button">Review this studio</button></a>


{% if favorited %}
<div id="favorite-div">
    <button style="color:red" id="favorite" data-id={{ studio.id }}>
        <span class="glyphicon glyphicon-heart"></span> Favorite
    </button>
    <span id="notes"></span>
    <span id="favorite-studio">This is one of your favorites!</span>
</div>
{% endif %}

{% if not favorited %}
<div id="favorite-div">
    <button id="favorite" data-id={{ studio.id }}>
        <span class="glyphicon glyphicon-heart"></span> Favorite
    </button>
    <span id="notes"></span>
    <span id="favorite-studio"></span>
</div>
{% endif %}

{% endif %}

{% endfor %}

    <script>

    function favorite() {
        if ($('#favorite').css('color') !== 'red') {
            function handleFavorite(evt) {
            var data = {
                        "studio_id": $("#favorite").data('id'),
                        };
            $.post('/favorite/studio', data, function (data) {
                $('#favorite-studio').text('You favorited this!');
                $('#favorite').css('color', 'red');
                });
            }
        }
        else {
            function removeFavorite(evt) {
            var data = {
                       "studio_id": $("#favorite").data('id')
                        };
            $.post('/unfavorite/studio', data, function (data) {
                $('#favorite-studio').text('You unfavorited this.')      
                $('#favorite').css('color', '');
                });  
            }
        }
    }

        // function handleFavorite(evt) {
        //     var data = {
        //                 "studio_id": $("#favorite").data('id'),
        //                 };
        //   $.post('/favorite/studio', data, function (data) {
        //     $('#favorite-studio').text('You favorited this!');
        //     $('#favorite').css('color', 'red');
        //   });
        // }


        // function removeFavorite(evt) {
        //     var data = {
        //                "studio_id": $("#favorite").data('id')
        //                 };
        //   $.post('/unfavorite/studio', data, function (data) {
        //     $('#favorite-studio').text('You unfavorited this.')       
        //     $('#favorite').css('color', '');
        //   });  
        // }

        // $('#favorite').toggle(handleFavorite, removeFavorite);

        // $('#favorite').toggle(handleFavorite);


        $('#favorite').on('click', favorite);

    
    </script>

{% endblock %}